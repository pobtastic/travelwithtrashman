<!DOCTYPE html>
<html>
<head>
<title>Travel With Trashman: Routine at 34406</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="34304.html">34304</a>
</td>
<td class="up">Up: <a href="../maps/all.html#34406">Map</a></td>
<td class="next">
Next: <a href="34633.html">34633</a>
</td>
</tr>
</table>
<div class="description">34406: Choose Location Or Take Job</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="32771.html">GameInitialise</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34406"></span>
<div class="comments">
<div class="paragraph">
<table class="">
<tr>
<td class="" colspan="1" rowspan="1"><img alt="choose-location" src="../../images/scr/choose-location.png" /></td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChooseLocationOrTakeJob</td>
<td class="address-2"><span id="34406"></span>34406</td>
<td class="instruction">LD B,1</td>
<td class="comment-1" rowspan="2">Call <a href="32853.html">32853</a> with a count of 1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34408"></span>34408</td>
<td class="instruction">CALL <a href="32853.html">32853</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34411"></span>34411</td>
<td class="instruction">LD HL,61435</td>
<td class="comment-1" rowspan="3">Jump to <a href="34406.html">ChooseLocationOrTakeJob</a> if bit 0 ("Ticker On/ Off") of *<a href="61435.html">GameState_2</a> is set.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34414"></span>34414</td>
<td class="instruction">BIT 0,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34416"></span>34416</td>
<td class="instruction">JR NZ,<a href="34406.html#34406">ChooseLocationOrTakeJob</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34418"></span>34418</td>
<td class="instruction">CALL <a href="35425.html">ClearMenuScreenAreas</a></td>
<td class="comment-1" rowspan="1">Call <a href="35425.html">ClearMenuScreenAreas</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34421"></span>
<div class="comments">
<div class="paragraph">
Prints "Destination   Fare".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34421"></span>34421</td>
<td class="instruction">LD HL,35944</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="35944.html">Messaging_TravelHeader</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34424"></span>34424</td>
<td class="instruction">LD DE,20554</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=20554 (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34427"></span>34427</td>
<td class="instruction">CALL <a href="35389.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="35389.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34430"></span>34430</td>
<td class="instruction">LD HL,20586</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=20586 (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34433"></span>34433</td>
<td class="instruction">LD B,11</td>
<td class="comment-1" rowspan="2"><a href="35383.html">Underline</a> the header with 11 character blocks of 255.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34435"></span>34435</td>
<td class="instruction">CALL <a href="35383.html">Underline</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34438"></span>34438</td>
<td class="instruction">LD HL,20600</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=20600 (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34441"></span>34441</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="2"><a href="35383.html">Underline</a> the header with 4 character blocks of 255.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34443"></span>34443</td>
<td class="instruction">CALL <a href="35383.html">Underline</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34446"></span>34446</td>
<td class="instruction">LD A,128</td>
<td class="comment-1" rowspan="2">Initialise *<a href="30737.html">TemporaryScreenLocation</a> to 128.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34448"></span>34448</td>
<td class="instruction">LD (30737),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34451"></span>34451</td>
<td class="instruction">LD IX,(61426)</td>
<td class="comment-1" rowspan="3">Loads the active players current location into <span class="register">BC</span> (using either *<a href="35880.html#35888">1UP_Location</a> or *<a href="35880.html#35904">2UP_Location</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34455"></span>34455</td>
<td class="instruction">LD C,(IX+8)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34458"></span>34458</td>
<td class="instruction">LD B,(IX+9)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34461"></span>34461</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the active players current location on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34462"></span>34462</td>
<td class="instruction">LD IX,2</td>
<td class="comment-1" rowspan="2">Move the pointer in <span class="register">IX</span> by 0002.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34466"></span>34466</td>
<td class="instruction">ADD IX,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34468"></span>34468</td>
<td class="instruction">LD L,(IX+0)</td>
<td class="comment-1" rowspan="2">Load the current locations map co-ordinates into <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34471"></span>34471</td>
<td class="instruction">LD H,(IX+1)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34474"></span>34474</td>
<td class="instruction">LD (30725),HL</td>
<td class="comment-1" rowspan="1">Write the current locations map co-ordinates to *<a href="30725.html">CurrentLocationCoOrdinates</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34477"></span>
<div class="comments">
<div class="paragraph">
Prints each destination (and cost) to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34477"></span>34477</td>
<td class="instruction">LD BC,2</td>
<td class="comment-1" rowspan="1">Set the increment value in <span class="register">BC</span> so <span class="register">IX</span> will point to the first flight destination from where the player is located.</td>
</tr>
<tr>
<td class="asm-label">PrintDestinations_Loop</td>
<td class="address-2"><span id="34480"></span>34480</td>
<td class="instruction">ADD IX,BC</td>
<td class="comment-1" rowspan="1">Move the pointer in <span class="register">IX</span> by the increment value in <span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34482"></span>34482</td>
<td class="instruction">LD L,(IX+0)</td>
<td class="comment-1" rowspan="2">Fetch the destination and store it in <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34485"></span>34485</td>
<td class="instruction">LD H,(IX+1)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34488"></span>34488</td>
<td class="instruction">LD A,96</td>
<td class="comment-1" rowspan="3">Jump to <a href="34406.html#34553">AllDestinationsPrinted</a> if all destinations have been printed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34490"></span>34490</td>
<td class="instruction">CP H</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34491"></span>34491</td>
<td class="instruction">JR NC,<a href="34406.html#34553">AllDestinationsPrinted</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34493"></span>34493</td>
<td class="instruction">LD DE,17</td>
<td class="comment-1" rowspan="2">Move the pointer in <span class="register">HL</span> to the destination name, the data before the name string is always 0017 bytes.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34496"></span>34496</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34497"></span>
<div class="comments">
<div class="paragraph">
Load the screen position for printing into <span class="register">DE</span>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34497"></span>34497</td>
<td class="instruction">LD D,80</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=80.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34499"></span>34499</td>
<td class="instruction">LD A,(30737)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="30737.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34502"></span>34502</td>
<td class="instruction">OR %00001001</td>
<td class="comment-1" rowspan="1">Set bits 0 and 3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34504"></span>34504</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34505"></span>
<div class="comments">
<div class="paragraph">
Print the destination location name to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34505"></span>34505</td>
<td class="instruction">CALL <a href="35389.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="35389.html">Print_String</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34508"></span>
<div class="comments">
<div class="paragraph">
Calculate where to print the cost.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34508"></span>34508</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">E</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34509"></span>34509</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34511"></span>34511</td>
<td class="instruction">OR %00011000</td>
<td class="comment-1" rowspan="1">Set bits 3-4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34513"></span>34513</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34514"></span>34514</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34516"></span>34516</td>
<td class="instruction">ADD A,32</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>+=32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34518"></span>34518</td>
<td class="instruction">LD (30737),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="30737.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34521"></span>34521</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1">Stash <span class="register">IX</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34523"></span>34523</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<span class="register">IX</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34525"></span>34525</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34526"></span>34526</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="3">Move <span class="register">HL</span> to the last digit of the cost, ready for printing.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34527"></span>34527</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34528"></span>34528</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34529"></span>34529</td>
<td class="instruction">LD BC,514</td>
<td class="comment-1" rowspan="1">Set the number format in <span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34532"></span>34532</td>
<td class="instruction">CALL <a href="38674.html">PrintNumbers</a></td>
<td class="comment-1" rowspan="1">Call <a href="38674.html">PrintNumbers</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34535"></span>34535</td>
<td class="instruction">POP IX</td>
<td class="comment-1" rowspan="1">Restore <span class="register">IX</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34537"></span>34537</td>
<td class="instruction">LD HL,65532</td>
<td class="comment-1" rowspan="3">Move the printing position in <span class="register">DE</span> back to the start of the cost.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34540"></span>34540</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34541"></span>34541</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34542"></span>
<div class="comments">
<div class="paragraph">
Now print "£".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34542"></span>34542</td>
<td class="instruction">LD HL,35878</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="35878.html">Messaging_£</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34545"></span>34545</td>
<td class="instruction">CALL <a href="35389.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="35389.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34548"></span>34548</td>
<td class="instruction">LD BC,4</td>
<td class="comment-1" rowspan="1">Set the increment in <span class="register">BC</span> to point to the next destination.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34551"></span>34551</td>
<td class="instruction">JR <a href="34406.html#34480">PrintDestinations_Loop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="34406.html#34480">PrintDestinations_Loop</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34553"></span>
<div class="comments">
<div class="paragraph">
Now deduce if the current location has a playable game or not.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">AllDestinationsPrinted</td>
<td class="address-2"><span id="34553"></span>34553</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore the current location into <span class="register">HL</span> (from the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34554"></span>34554</td>
<td class="instruction">LD DE,16</td>
<td class="comment-1" rowspan="3">Move <span class="register">HL</span> to this locations "state" and load the state into <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34557"></span>34557</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34558"></span>34558</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34559"></span>34559</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="5">Jump to <a href="34406.html#34571">ShiftLocationState</a> if *<a href="61426.html">Pointer_ActivePlayer</a> is pointing to <a href="35880.html">1UP_Name</a> (is this player one?)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34560"></span>34560</td>
<td class="instruction">LD HL,(61426)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34563"></span>34563</td>
<td class="instruction">LD DE,35880</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34566"></span>34566</td>
<td class="instruction">SBC HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34568"></span>34568</td>
<td class="instruction">JR Z,<a href="34406.html#34571">ShiftLocationState</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34570"></span>
<div class="comments">
<div class="paragraph">
This is player two, so shift the location state right through two positions.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34570"></span>34570</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">Set the carry flag if 2UP has completed the sub-game at this location.</td>
</tr>
<tr>
<td class="asm-label">ShiftLocationState</td>
<td class="address-2"><span id="34571"></span>34571</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">Set the carry flag if 1UP has completed the sub-game at this destination).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34572"></span>34572</td>
<td class="instruction">LD B,224</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=224.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34574"></span>
<div class="comments">
<div class="paragraph">
Decide which message to print; "Job completed" or "Accept job offered".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34574"></span>34574</td>
<td class="instruction">LD HL,35962</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="35962.html">Messaging_JobComplete</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34577"></span>34577</td>
<td class="instruction">JR C,<a href="34406.html#34584">PrintJobMessaging</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="34406.html#34584">PrintJobMessaging</a> if the game at this location has already been completed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34579"></span>34579</td>
<td class="instruction">LD B,0</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34581"></span>34581</td>
<td class="instruction">LD HL,35975</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="35975.html">Messaging_AcceptJobOffered</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34584"></span>
<div class="comments">
<div class="paragraph">
Calculate where to print the messaging.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PrintJobMessaging</td>
<td class="address-2"><span id="34584"></span>34584</td>
<td class="instruction">LD A,(30737)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="30737.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34587"></span>34587</td>
<td class="instruction">OR %00001010</td>
<td class="comment-1" rowspan="1">Set bits 1 and 3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34589"></span>34589</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34590"></span>34590</td>
<td class="instruction">LD D,80</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=80.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34592"></span>34592</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34594"></span>34594</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>+=<span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34595"></span>34595</td>
<td class="instruction">LD (30737),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="30737.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34598"></span>34598</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34599"></span>
<div class="comments">
<div class="paragraph">
Print either "Job completed" or "Accept job offered" to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34599"></span>34599</td>
<td class="instruction">CALL <a href="35389.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="35389.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34602"></span>34602</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34603"></span>34603</td>
<td class="instruction">CP 0</td>
<td class="comment-1" rowspan="2">Return if <span class="register">A</span> is equal to 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34605"></span>34605</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34606"></span>34606</td>
<td class="instruction">LD IX,(61426)</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="61426.html">Pointer_ActivePlayer</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34610"></span>34610</td>
<td class="instruction">CALL <a href="35151.html">Check_AffordToFly</a></td>
<td class="comment-1" rowspan="1">Call <a href="35151.html">Check_AffordToFly</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34613"></span>34613</td>
<td class="instruction">RET NC</td>
<td class="comment-1" rowspan="1">Return if the player can afford the "cheapest" destination.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="34614"></span>
<div class="comments">
<div class="paragraph">
The active player can't afford to fly anywhere.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34614"></span>34614</td>
<td class="instruction">RES 7,(IX+15)</td>
<td class="comment-1" rowspan="1">Reset bit 7 of *<span class="register">IX</span>+15.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34618"></span>34618</td>
<td class="instruction">LD B,100</td>
<td class="comment-1" rowspan="2">Call <a href="32853.html">32853</a> with a count of 100.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34620"></span>34620</td>
<td class="instruction">CALL <a href="32853.html">32853</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34623"></span>34623</td>
<td class="instruction">CALL <a href="35425.html">ClearMenuScreenAreas</a></td>
<td class="comment-1" rowspan="1">Call <a href="35425.html">ClearMenuScreenAreas</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34626"></span>34626</td>
<td class="instruction">CALL <a href="33339.html">Messaging_GenerateTicker</a></td>
<td class="comment-1" rowspan="1">Call <a href="33339.html">Messaging_GenerateTicker</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34629"></span>34629</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="34630"></span>34630</td>
<td class="instruction">JP <a href="34876.html#35075">Handler_SubGame_6</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="34876.html#35075">Handler_SubGame_6</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="34304.html">34304</a>
</td>
<td class="up">Up: <a href="../maps/all.html#34406">Map</a></td>
<td class="next">
Next: <a href="34633.html">34633</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1984 New Generation Software &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.3.</div>
<div class="repository">Link to <a href="https://github.com/pobtastic/travelwithtrashman/">Source code</a>.</div>
<div><a href="asm/34406.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>