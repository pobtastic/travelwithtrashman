<!DOCTYPE html>
<html>
<head>
<title>Travel With Trashman: Routine at C824</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="C7B6.html">C7B6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#c824">Map</a></td>
<td class="next">
Next: <a href="C869.html">C869</a>
</td>
</tr>
</table>
<div class="description">C824: Handler: Moscow2</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="C7B6.html">Handler_Moscow</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c824"></span>
<div class="comments">
<div class="paragraph">
See <a href="../reference/pokes.html#moscow">You Are Not Deported From Moscow</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Handler_Moscow2</td>
<td class="address-2"><span id="c824"></span>C824</td>
<td class="instruction">CP $40</td>
<td class="comment-1" rowspan="2">Jump to <a href="C824.html#c832">Handler_Moscow2_0</a> if <span class="register">A</span> is not equal to 40.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c826"></span>C826</td>
<td class="instruction">JR NZ,<a href="C824.html#c832">Handler_Moscow2_0</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c828"></span>C828</td>
<td class="instruction">LD HL,$EFFA</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="EFFA.html">GameState_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c82b"></span>C82B</td>
<td class="instruction">SET 2,(HL)</td>
<td class="comment-1" rowspan="1">Set bit 2 of *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c82d"></span>C82D</td>
<td class="instruction">LD SP,($99AE)</td>
<td class="comment-1" rowspan="1"><span class="register">SP</span>=*99AE.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c831"></span>C831</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="asm-label">Handler_Moscow2_0</td>
<td class="address-2"><span id="c832"></span>C832</td>
<td class="instruction">CALL <a href="97D7.html">$97D7</a></td>
<td class="comment-1" rowspan="1">Call <a href="97D7.html">97D7</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c835"></span>C835</td>
<td class="instruction">LD A,(IX+$06)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<span class="register">IX</span>+06.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c838"></span>C838</td>
<td class="instruction">CP C</td>
<td class="comment-1" rowspan="1">Compare <span class="register">A</span> with <span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c839"></span>C839</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c83a"></span>C83A</td>
<td class="instruction">JR NZ,<a href="C824.html#c83d">Handler_Moscow2_1</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="C824.html#c83d">Handler_Moscow2_1</a> if <span class="register">A</span> is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c83c"></span>C83C</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="2">Write <span class="register">B</span> to *<span class="register">IX</span>+06.</td>
</tr>
<tr>
<td class="asm-label">Handler_Moscow2_1</td>
<td class="address-2"><span id="c83d"></span>C83D</td>
<td class="instruction">LD (IX+$06),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c840"></span>C840</td>
<td class="instruction">CALL <a href="C824.html#c846">Handler_Moscow2_2</a></td>
<td class="comment-1" rowspan="1">Call <a href="C824.html#c846">Handler_Moscow2_2</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c843"></span>C843</td>
<td class="instruction">JP <a href="9926.html">$9926</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="9926.html">9926</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c846"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="C7B6.html">Handler_Moscow</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Handler_Moscow2_2</td>
<td class="address-2"><span id="c846"></span>C846</td>
<td class="instruction">CALL <a href="9619.html">$9619</a></td>
<td class="comment-1" rowspan="1">Call <a href="9619.html">9619</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c849"></span>C849</td>
<td class="instruction">AND %00000011</td>
<td class="comment-1" rowspan="1">Keep only bits 0-1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c84b"></span>C84B</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">Increment <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c84c"></span>C84C</td>
<td class="instruction">LD IX,($99E3)</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=*<a href="99C4.html#99e3">99E3</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c850"></span>C850</td>
<td class="instruction">LD (IX+$07),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<span class="register">IX</span>+07.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c853"></span>C853</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c854"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="C7B6.html">Handler_Moscow</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Handler_Moscow2_3</td>
<td class="address-2"><span id="c854"></span>C854</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="2">Write 00 to *<a href="9969.html#99aa">99AA</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c856"></span>C856</td>
<td class="instruction">LD ($99AA),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c859"></span>C859</td>
<td class="instruction">CALL <a href="97D7.html#980e">$980E</a></td>
<td class="comment-1" rowspan="1">Call <a href="97D7.html#980e">980E</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c85c"></span>C85C</td>
<td class="instruction">CALL <a href="97D7.html#98ab">$98AB</a></td>
<td class="comment-1" rowspan="1">Call <a href="97D7.html#98ab">98AB</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c85f"></span>C85F</td>
<td class="instruction">LD B,$78</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=78.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c861"></span>C861</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c862"></span>C862</td>
<td class="instruction">OR %11000000</td>
<td class="comment-1" rowspan="1">Set bits 6-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c864"></span>C864</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c865"></span>C865</td>
<td class="instruction">CALL <a href="98F2.html">$98F2</a></td>
<td class="comment-1" rowspan="1">Call <a href="98F2.html">98F2</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c868"></span>C868</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="C7B6.html">C7B6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#c824">Map</a></td>
<td class="next">
Next: <a href="C869.html">C869</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1984 New Generation Software &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.3.</div>
<div class="repository">Link to <a href="https://github.com/pobtastic/travelwithtrashman/">Source code</a>.</div>
<div><a href="asm/C824.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>