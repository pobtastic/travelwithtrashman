<!DOCTYPE html>
<html>
<head>
<title>Travel With Trashman: Routine at 8666</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="8600.html">8600</a>
</td>
<td class="up">Up: <a href="../maps/all.html#8666">Map</a></td>
<td class="next">
Next: <a href="8749.html">8749</a>
</td>
</tr>
</table>
<div class="description">8666: Choose Location Or Take Job</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="8003.html">GameInitialise</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8666"></span>
<div class="comments">
<div class="paragraph">
<table class="">
<tr>
<td class="" colspan="1" rowspan="1"><img alt="choose-location" src="../images/scr/choose-location.png" /></td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChooseLocationOrTakeJob</td>
<td class="address-2"><span id="8666"></span>8666</td>
<td class="instruction">LD B,$01</td>
<td class="comment-1" rowspan="2">Call <a href="8055.html">8055</a> with a count of 01.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8668"></span>8668</td>
<td class="instruction">CALL <a href="8055.html">$8055</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="866b"></span>866B</td>
<td class="instruction">LD HL,$EFFB</td>
<td class="comment-1" rowspan="3">Jump to <a href="8666.html">ChooseLocationOrTakeJob</a> if bit 0 ("Ticker On/ Off") of *<a href="EFFB.html">GameState_2</a> is set.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="866e"></span>866E</td>
<td class="instruction">BIT 0,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8670"></span>8670</td>
<td class="instruction">JR NZ,<a href="8666.html#8666">ChooseLocationOrTakeJob</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8672"></span>8672</td>
<td class="instruction">CALL <a href="8A61.html">ClearMenuScreenAreas</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A61.html">ClearMenuScreenAreas</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8675"></span>
<div class="comments">
<div class="paragraph">
Prints "Destination   Fare".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8675"></span>8675</td>
<td class="instruction">LD HL,$8C68</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="8C68.html">Messaging_TravelHeader</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8678"></span>8678</td>
<td class="instruction">LD DE,$504A</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=504A (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="867b"></span>867B</td>
<td class="instruction">CALL <a href="8A3D.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A3D.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="867e"></span>867E</td>
<td class="instruction">LD HL,$506A</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=506A (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8681"></span>8681</td>
<td class="instruction">LD B,$0B</td>
<td class="comment-1" rowspan="2"><a href="8A37.html">Underline</a> the header with 0B character blocks of FF.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8683"></span>8683</td>
<td class="instruction">CALL <a href="8A37.html">Underline</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8686"></span>8686</td>
<td class="instruction">LD HL,$5078</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=5078 (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8689"></span>8689</td>
<td class="instruction">LD B,$04</td>
<td class="comment-1" rowspan="2"><a href="8A37.html">Underline</a> the header with 04 character blocks of FF.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="868b"></span>868B</td>
<td class="instruction">CALL <a href="8A37.html">Underline</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="868e"></span>868E</td>
<td class="instruction">LD A,$80</td>
<td class="comment-1" rowspan="2">Initialise *<a href="7811.html">TemporaryScreenLocation</a> to 80.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8690"></span>8690</td>
<td class="instruction">LD ($7811),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8693"></span>8693</td>
<td class="instruction">LD IX,($EFF2)</td>
<td class="comment-1" rowspan="3">Loads the active players current location into <span class="register">BC</span> (using either *<a href="8C28.html#8c30">1UP_Location</a> or *<a href="8C28.html#8c40">2UP_Location</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8697"></span>8697</td>
<td class="instruction">LD C,(IX+$08)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="869a"></span>869A</td>
<td class="instruction">LD B,(IX+$09)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="869d"></span>869D</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the active players current location on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="869e"></span>869E</td>
<td class="instruction">LD IX,$0002</td>
<td class="comment-1" rowspan="2">Move the pointer in <span class="register">IX</span> by 0002.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86a2"></span>86A2</td>
<td class="instruction">ADD IX,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86a4"></span>86A4</td>
<td class="instruction">LD L,(IX+$00)</td>
<td class="comment-1" rowspan="2">Load the current locations map co-ordinates into <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86a7"></span>86A7</td>
<td class="instruction">LD H,(IX+$01)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86aa"></span>86AA</td>
<td class="instruction">LD ($7805),HL</td>
<td class="comment-1" rowspan="1">Write the current locations map co-ordinates to *<a href="7805.html">CurrentLocationCoordinates</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86ad"></span>
<div class="comments">
<div class="paragraph">
Prints each destination (and cost) to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ad"></span>86AD</td>
<td class="instruction">LD BC,$0002</td>
<td class="comment-1" rowspan="1">Set the increment value in <span class="register">BC</span> so <span class="register">IX</span> will point to the first flight destination from where the player is located.</td>
</tr>
<tr>
<td class="asm-label">PrintDestinations_Loop</td>
<td class="address-2"><span id="86b0"></span>86B0</td>
<td class="instruction">ADD IX,BC</td>
<td class="comment-1" rowspan="1">Move the pointer in <span class="register">IX</span> by the increment value in <span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86b2"></span>86B2</td>
<td class="instruction">LD L,(IX+$00)</td>
<td class="comment-1" rowspan="2">Fetch the destination and store it in <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86b5"></span>86B5</td>
<td class="instruction">LD H,(IX+$01)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86b8"></span>86B8</td>
<td class="instruction">LD A,$60</td>
<td class="comment-1" rowspan="3">Jump to <a href="8666.html#86f9">AllDestinationsPrinted</a> if all destinations have been printed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ba"></span>86BA</td>
<td class="instruction">CP H</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86bb"></span>86BB</td>
<td class="instruction">JR NC,<a href="8666.html#86f9">AllDestinationsPrinted</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86bd"></span>86BD</td>
<td class="instruction">LD DE,$0011</td>
<td class="comment-1" rowspan="2">Move the pointer in <span class="register">HL</span> to the destination name, the data before the name string is always 0011 bytes.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c0"></span>86C0</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86c1"></span>
<div class="comments">
<div class="paragraph">
Load the screen position for printing into <span class="register">DE</span>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c1"></span>86C1</td>
<td class="instruction">LD D,$50</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=50.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c3"></span>86C3</td>
<td class="instruction">LD A,($7811)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="7811.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c6"></span>86C6</td>
<td class="instruction">OR %00001001</td>
<td class="comment-1" rowspan="1">Set bits 0 and 3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c8"></span>86C8</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86c9"></span>
<div class="comments">
<div class="paragraph">
Print the destination location name to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86c9"></span>86C9</td>
<td class="instruction">CALL <a href="8A3D.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A3D.html">Print_String</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86cc"></span>
<div class="comments">
<div class="paragraph">
Calculate where to print the cost.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86cc"></span>86CC</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">E</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86cd"></span>86CD</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86cf"></span>86CF</td>
<td class="instruction">OR %00011000</td>
<td class="comment-1" rowspan="1">Set bits 3-4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86d1"></span>86D1</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86d2"></span>86D2</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86d4"></span>86D4</td>
<td class="instruction">ADD A,$20</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>+=20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86d6"></span>86D6</td>
<td class="instruction">LD ($7811),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="7811.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86d9"></span>86D9</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1">Stash <span class="register">IX</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86db"></span>86DB</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<span class="register">IX</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86dd"></span>86DD</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86de"></span>86DE</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="3">Move <span class="register">HL</span> to the last digit of the cost, ready for printing.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86df"></span>86DF</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86e0"></span>86E0</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86e1"></span>86E1</td>
<td class="instruction">LD BC,$0202</td>
<td class="comment-1" rowspan="1">Set the number format in <span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86e4"></span>86E4</td>
<td class="instruction">CALL <a href="9712.html">PrintNumbers</a></td>
<td class="comment-1" rowspan="1">Call <a href="9712.html">PrintNumbers</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86e7"></span>86E7</td>
<td class="instruction">POP IX</td>
<td class="comment-1" rowspan="1">Restore <span class="register">IX</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86e9"></span>86E9</td>
<td class="instruction">LD HL,$FFFC</td>
<td class="comment-1" rowspan="3">Move the printing position in <span class="register">DE</span> back to the start of the cost.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ec"></span>86EC</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ed"></span>86ED</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86ee"></span>
<div class="comments">
<div class="paragraph">
Now print "£".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ee"></span>86EE</td>
<td class="instruction">LD HL,$8C26</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="8C26.html">Messaging_£</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86f1"></span>86F1</td>
<td class="instruction">CALL <a href="8A3D.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A3D.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86f4"></span>86F4</td>
<td class="instruction">LD BC,$0004</td>
<td class="comment-1" rowspan="1">Set the increment in <span class="register">BC</span> to point to the next destination.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86f7"></span>86F7</td>
<td class="instruction">JR <a href="8666.html#86b0">PrintDestinations_Loop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="8666.html#86b0">PrintDestinations_Loop</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="86f9"></span>
<div class="comments">
<div class="paragraph">
Now deduce if the current location has a playable game or not.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">AllDestinationsPrinted</td>
<td class="address-2"><span id="86f9"></span>86F9</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore the current location into <span class="register">HL</span> (from the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86fa"></span>86FA</td>
<td class="instruction">LD DE,$0010</td>
<td class="comment-1" rowspan="3">Move <span class="register">HL</span> to this locations "state" and load the state into <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86fd"></span>86FD</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86fe"></span>86FE</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="86ff"></span>86FF</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="5">Jump to <a href="8666.html#870b">ShiftLocationState</a> if *<a href="EFF2.html">Pointer_ActivePlayer</a> is pointing to <a href="8C28.html">1UP_Name</a> (is this player one?)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8700"></span>8700</td>
<td class="instruction">LD HL,($EFF2)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8703"></span>8703</td>
<td class="instruction">LD DE,$8C28</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8706"></span>8706</td>
<td class="instruction">SBC HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8708"></span>8708</td>
<td class="instruction">JR Z,<a href="8666.html#870b">ShiftLocationState</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="870a"></span>
<div class="comments">
<div class="paragraph">
This is player two, so shift the location state right through two positions.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="870a"></span>870A</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">Set the carry flag if 2UP has completed the sub-game at this location.</td>
</tr>
<tr>
<td class="asm-label">ShiftLocationState</td>
<td class="address-2"><span id="870b"></span>870B</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">Set the carry flag if 1UP has completed the sub-game at this destination).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="870c"></span>870C</td>
<td class="instruction">LD B,$E0</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=E0.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="870e"></span>
<div class="comments">
<div class="paragraph">
Decide which message to print; "Job completed" or "Accept job offered".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="870e"></span>870E</td>
<td class="instruction">LD HL,$8C7A</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="8C7A.html">Messaging_JobComplete</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8711"></span>8711</td>
<td class="instruction">JR C,<a href="8666.html#8718">PrintJobMessaging</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="8666.html#8718">PrintJobMessaging</a> if the game at this location has already been completed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8713"></span>8713</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8715"></span>8715</td>
<td class="instruction">LD HL,$8C87</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="8C87.html">Messaging_AcceptJobOffered</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8718"></span>
<div class="comments">
<div class="paragraph">
Calculate where to print the messaging.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PrintJobMessaging</td>
<td class="address-2"><span id="8718"></span>8718</td>
<td class="instruction">LD A,($7811)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="7811.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="871b"></span>871B</td>
<td class="instruction">OR %00001010</td>
<td class="comment-1" rowspan="1">Set bits 1 and 3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="871d"></span>871D</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="871e"></span>871E</td>
<td class="instruction">LD D,$50</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=50.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8720"></span>8720</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8722"></span>8722</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>+=<span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8723"></span>8723</td>
<td class="instruction">LD ($7811),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="7811.html">TemporaryScreenLocation</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8726"></span>8726</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8727"></span>
<div class="comments">
<div class="paragraph">
Print either "Job completed" or "Accept job offered" to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8727"></span>8727</td>
<td class="instruction">CALL <a href="8A3D.html">Print_String</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A3D.html">Print_String</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="872a"></span>872A</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="872b"></span>872B</td>
<td class="instruction">CP $00</td>
<td class="comment-1" rowspan="2">Return if <span class="register">A</span> is equal to 00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="872d"></span>872D</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="872e"></span>872E</td>
<td class="instruction">LD IX,($EFF2)</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="EFF2.html">Pointer_ActivePlayer</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8732"></span>8732</td>
<td class="instruction">CALL <a href="894F.html">Check_AffordToFly</a></td>
<td class="comment-1" rowspan="1">Call <a href="894F.html">Check_AffordToFly</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8735"></span>8735</td>
<td class="instruction">RET NC</td>
<td class="comment-1" rowspan="1">Return if the player can afford the "cheapest" destination.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8736"></span>
<div class="comments">
<div class="paragraph">
The active player can't afford to fly anywhere.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8736"></span>8736</td>
<td class="instruction">RES 7,(IX+$0F)</td>
<td class="comment-1" rowspan="1">Reset bit 7 of *<span class="register">IX</span>+0F.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="873a"></span>873A</td>
<td class="instruction">LD B,$64</td>
<td class="comment-1" rowspan="2">Call <a href="8055.html">8055</a> with a count of 64.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="873c"></span>873C</td>
<td class="instruction">CALL <a href="8055.html">$8055</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="873f"></span>873F</td>
<td class="instruction">CALL <a href="8A61.html">ClearMenuScreenAreas</a></td>
<td class="comment-1" rowspan="1">Call <a href="8A61.html">ClearMenuScreenAreas</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8742"></span>8742</td>
<td class="instruction">CALL <a href="823B.html">Messaging_GenerateTicker</a></td>
<td class="comment-1" rowspan="1">Call <a href="823B.html">Messaging_GenerateTicker</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8745"></span>8745</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8746"></span>8746</td>
<td class="instruction">JP <a href="883C.html#8903">Handler_SubGame_6</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="883C.html#8903">Handler_SubGame_6</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="8600.html">8600</a>
</td>
<td class="up">Up: <a href="../maps/all.html#8666">Map</a></td>
<td class="next">
Next: <a href="8749.html">8749</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1984 New Generation Software &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.3.</div>
<div class="repository">Link to <a href="https://github.com/pobtastic/travelwithtrashman/">Source code</a>.</div>
<div><a href="asm/8666.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>